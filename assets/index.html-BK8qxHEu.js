import{_ as i,c as l,a as o,o as t}from"./app-BYecpAAQ.js";const c={};function a(d,e){return t(),l("div",null,e[0]||(e[0]=[o("<ul><li><p><code>read</code>系统调用：</p><ul><li>参数检查： <ul><li>检查文件描述符存在性</li><li>检查当前文件读写位置（通过<code>file_ppos</code>），该位置是<code>file</code>对象的，不是文件的，也就是说，同一个文件的两个句柄存有不同的位置</li><li>检查权限（在<code>inode</code>结构中，如果没有权限，返回<code>-EACCESS</code>）</li></ul></li><li>调用<code>VFS</code>的读函数： <ul><li>普通文件：通过超级块和<code>inode</code>,使用块设备驱动读取到内核缓冲区，如果已经在缓存中，则直接使用，最后拷贝到用户空间</li><li>设备文件：调用设备驱动的<code>read</code>函数</li></ul></li><li>更新文件位置，返回结果</li></ul></li><li><p><code>write</code>系统调用：</p><ul><li>参数检查（同<code>read</code>）</li><li>将数据从用户空间复制到内核缓冲区，调用<code>VFS</code>读函数 <ul><li>普通文件：通过<code>inode</code>和超级块定位写文件位置，如果超出大小，则扩展（根据文件系统的不同而不同），然后通过块设备驱动写入磁盘</li><li>设备文件：调用设备驱动的<code>write</code>函数</li></ul></li><li>更新文件位置，返回结果（成功写入的长度）</li></ul><blockquote><p>一般写时会有延迟写入，<code>write</code>会暂时保存在缓冲中，在合适的时候写入（比如<code>umount</code>）</p></blockquote></li><li><p>内核态和用户态：</p><ul><li>内核态：权限高，可以执行所有CPU指令（包括特权指令），可以直接访问硬件</li><li>用户态：权限低，只能执行用户级别指令，不能直接访问硬件，需要使用资源时，需要借助系统调用等操作系统API</li></ul></li><li><p>从用户态切入内核态：</p><ul><li>异常和中断处理（被动）</li><li>系统调用（主动）</li><li>缺页异常（可以认为是主动）</li></ul></li><li><p>中断现场保存在哪（<code>x86</code>）：在内核栈上，中断发生时，CPU负责将当前指令位置和相关寄存器保存到内核栈上（中断帧），然后查询中断向量表进入中断处理函数；如果是在用户态触发，则由TSS段负责切换到内核栈（提权），再进入中断处理函数。</p></li><li><p>内存屏障：控制CPU核心之间按照一定的顺序访问某块内存，防止由于CPU优化等导致的缓存不一致行为（保证其他核心看到的是修改后的数据），常用来实现同步原语、中断处理中的数据修改、外设IO操作等</p></li><li><p>Linux内存申请：</p><ul><li><code>kmalloc</code>申请不仅虚拟内存和物理内存都连续的内存，可用于DMA，用于较小内存分配</li><li><code>vmalloc</code>申请虚拟连续，物理不一定连续的内存，不可用于DMA</li><li><code>__get_free_pages</code>伙伴系统，获取连续页</li></ul></li><li><p>写时复制（COW）：拷贝对象时不进行复制，而是先绑定引用，当其中一个对象进行修改时，为其复制这部分数据，提高内存的使用效率。操作系统中用于进程虚拟内存管理、现代语言的标准库中用来优化对象之间的拷贝。</p></li><li><p>Linux页大小：一般是<code>4KB</code>，但也支持<code>2MB</code>大页，<code>1GB</code>超大页</p><ul><li><code>4KB</code>页：大多数现代处理器原生支持4KB页</li><li>大页：对于大量连续物理内存内存的场景可以减少TLB缺失，也可以减少所需页表条目大小，降低分页管理的开销。</li></ul></li><li><p>页面异常（Page Fault）：在访问虚拟页出现问题时触发（缺页异常、保护错误）</p><ul><li>越界访问、非法地址等问题</li><li>页面可能在内存中（交换机制）</li><li>COW，需要在中断中进行复制</li><li>共享库的延迟加载，需要加载器介入</li></ul></li></ul>",1)]))}const p=i(c,[["render",a]]),n=JSON.parse('{"path":"/article/6om3z3d1/","title":"秋招面经笔记-操作系统&Linux串烧2","lang":"zh-CN","frontmatter":{"title":"秋招面经笔记-操作系统&Linux串烧2","createTime":"2025/08/20 22:00:47","permalink":"/article/6om3z3d1/","tags":["OS","Linux"],"description":"read系统调用： 参数检查： 检查文件描述符存在性 检查当前文件读写位置（通过file_ppos），该位置是file对象的，不是文件的，也就是说，同一个文件的两个句柄存有不同的位置 检查权限（在inode结构中，如果没有权限，返回-EACCESS） 调用VFS的读函数： 普通文件：通过超级块和inode,使用块设备驱动读取到内核缓冲区，如果已经在缓存...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"秋招面经笔记-操作系统&Linux串烧2\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-10-08T11:03:23.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://dessera.github.io/article/6om3z3d1/"}],["meta",{"property":"og:site_name","content":"Dessera Lab"}],["meta",{"property":"og:title","content":"秋招面经笔记-操作系统&Linux串烧2"}],["meta",{"property":"og:description","content":"read系统调用： 参数检查： 检查文件描述符存在性 检查当前文件读写位置（通过file_ppos），该位置是file对象的，不是文件的，也就是说，同一个文件的两个句柄存有不同的位置 检查权限（在inode结构中，如果没有权限，返回-EACCESS） 调用VFS的读函数： 普通文件：通过超级块和inode,使用块设备驱动读取到内核缓冲区，如果已经在缓存..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-10-08T11:03:23.000Z"}],["meta",{"property":"article:tag","content":"Linux"}],["meta",{"property":"article:tag","content":"OS"}],["meta",{"property":"article:modified_time","content":"2025-10-08T11:03:23.000Z"}]]},"readingTime":{"minutes":3.14,"words":941},"git":{"createdTime":1756704881000,"updatedTime":1759921403000,"contributors":[{"name":"Dessera","username":"Dessera","email":"dessera@qq.com","commits":2,"avatar":"https://avatars.githubusercontent.com/Dessera?v=4","url":"https://github.com/Dessera"}],"changelog":[{"hash":"8822e76d8d2b38cdc55efc7d8980256c70213d4a","time":1759921403000,"email":"dessera@qq.com","author":"Dessera","message":"MNN01"},{"hash":"4bba06d9b785537f52e46870bcdeeebfdf47cbac","time":1756704881000,"email":"dessera@qq.com","author":"Dessera","message":"C++11"}]},"autoDesc":true,"filePathRelative":"笔记/秋招面经笔记-操作系统&Linux串烧2.md","headers":[],"categoryList":[{"id":"7051dc","sort":10000,"name":"笔记"}]}');export{p as comp,n as data};
